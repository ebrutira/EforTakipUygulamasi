@model EforTakipUygulamasi.Controllers.ReportData
@{
    ViewData["Title"] = "Raporlar";
}

<div class="container">
    <!-- Rapor Başlığı -->
    <div style="background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 2rem;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h1 style="margin: 0; color: #333;">📊 Efor Takip Raporları</h1>
            <div style="display: flex; gap: 1rem;">
                <a href="/Report/ExportData?format=csv" class="btn btn-secondary">📄 CSV İndir</a>
                <a href="/Report/ExportData?format=json" class="btn btn-primary">📁 JSON İndir</a>
            </div>
        </div>
        <p style="color: #666; margin: 0.5rem 0 0 0;">Son güncelleme: @DateTime.Now.ToString("dd.MM.yyyy HH:mm")</p>
    </div>

    <!-- Basit İstatistikler -->
    <div class="dashboard-stats">
        <div class="stat-card">
            <div class="stat-value">@Model.TotalRequests</div>
            <div class="stat-label">Toplam Talep</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">@Model.CompletedRequests</div>
            <div class="stat-label">Tamamlanan</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">@Model.InProgressRequests</div>
            <div class="stat-label">Devam Eden</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">@Model.TotalHours.ToString("F0")</div>
            <div class="stat-label">Toplam Saat</div>
        </div>
        <div class="stat-card">
            <div class="stat-value">@(Model.TotalRequests > 0 ? (Model.TotalHours / Model.TotalRequests).ToString("F1") : "0")</div>
            <div class="stat-label">Ortalama Saat</div>
        </div>
    </div>

    <!-- Efor Dağılımı -->
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
        <div style="background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <h3 style="margin-bottom: 1rem; color: #333;">Efor Dağılımı</h3>
            <div style="display: grid; gap: 0.5rem;">
                <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f7fafc; border-radius: 4px;">
                    <span>👨‍💼 Analiz:</span>
                    <strong>@Model.AnalystTotalHours.ToString("F1") saat</strong>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f7fafc; border-radius: 4px;">
                    <span>💻 Yazılım:</span>
                    <strong>@Model.DeveloperTotalHours.ToString("F1") saat</strong>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f7fafc; border-radius: 4px;">
                    <span>🧪 KKT:</span>
                    <strong>@Model.KKTTotalHours.ToString("F1") saat</strong>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f7fafc; border-radius: 4px;">
                    <span>🚀 Preprod:</span>
                    <strong>@Model.PreprodTotalHours.ToString("F1") saat</strong>
                </div>
            </div>
        </div>

        <!-- Performans Metrikleri -->
        <div style="background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <h3 style="margin-bottom: 1rem; color: #333;">Performans Metrikleri</h3>
            <div style="display: grid; gap: 0.5rem;">
                <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f7fafc; border-radius: 4px;">
                    <span>📅 Bu Ay Oluşturulan:</span>
                    <strong>@Model.ThisMonthCreated talep</strong>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f7fafc; border-radius: 4px;">
                    <span>📆 Bu Hafta Oluşturulan:</span>
                    <strong>@Model.ThisWeekCreated talep</strong>
                </div>
                <div style="display: flex; justify-content: space-between; padding: 0.5rem; background: #f7fafc; border-radius: 4px;">
                    <span>✅ Tamamlanma Oranı:</span>
                    <strong>@Model.CompletionRate.ToString("F1")%</strong>
                </div>
            </div>
        </div>
    </div>

    <!-- Rapor Açıklaması -->
    <div style="background: white; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        <h3 style="margin-bottom: 1rem; color: #333;">📋 Rapor Özeti</h3>
        <div style="line-height: 1.6; color: #555;">
            <p><strong>Genel Durum:</strong> Toplam @Model.TotalRequests iş talebi bulunmakta, bunların @Model.InProgressRequests'i aktif olarak devam etmekte, @Model.CompletedRequests'i tamamlanmış durumda.</p>

            <p><strong>Efor Analizi:</strong> En çok efor yazılım geliştirme kısmında harcanmış (@Model.DeveloperTotalHours saat), bunu analist çalışmaları (@Model.AnalystTotalHours saat) takip ediyor.</p>

            <p><strong>Performans:</strong> Tamamlanma oranı %@Model.CompletionRate.ToString("F1") seviyesinde. Geciken iş oranı %@Model.OverdueRate.ToString("F1") ile @(Model.OverdueRate <= 10 ? "kabul edilebilir" : "iyileştirme gerektiren") seviyede.</p>

            <p><strong>Öneriler:</strong></p>
            <ul style="margin-left: 1.5rem;">
                @if (Model.DeveloperTotalHours > Model.AnalystTotalHours * 2)
                {
                    <li>Yazılım geliştirme süreçleri optimize edilebilir</li>
                }
                @if (Model.KKTTotalHours < Model.DeveloperTotalHours * 0.3m)
                {
                    <li>Test süreçleri için daha fazla kaynak ayrılmalı</li>
                }
                @if (Model.OverdueRate > 10)
                {
                    <li>Deadline takibi güçlendirilmeli</li>
                }
                <li>Yazılım geliştirme süreçleri optimize edilebilir</li>
                <li>Test süreçleri için daha fazla kaynak ayrılmalı</li>
                <li>Deadline takibi güçlendirilmeli</li>
            </ul>
        </div>
    </div>
</div>